# Obtain the dataset
```
pip install tensor2tensor
PROBLEM=translate_ende_wmt_bpe32k

MODEL=transformer
HPARAMS=transformer_base_single_gpu

DATA_DIR=$HOME/shr/t2t_data
TMP_DIR=$HOME/tmp/t2t_datagen
mkdir -p $DATA_DIR $TMP_DIR
t2t-datagen \
  --data_dir=$DATA_DIR \
  --tmp_dir=$TMP_DIR \
  --problem=$PROBLEM
```

# Process the dataset provided by tensor2tensor
1. Process the TFRecord File generated by tensor2tensot, to output the plain-text training file
```
python extract_data.py
```
2. Remove the `<PAD> <EOS> <UNK>` tokens in the vocab.bpe.32000
```
#enter the `~/t2t_data/' direcroty
#mkdir wmt_ende
#move the corresponding training file, eval file and test file to wmt_ende directory
```

# training the model:

```
python transformer.py
```

# evaluation on test dataset newstest2014
```
bash run_en_de_wmt.sh
# enter the args.log_dir directory
cat #model#.b5alpha0.6.output.txt | sed 's/@@ //g' > outputs.words
t2t-bleu --translation=outputs.words --reference=newstest2014.tok.de
```
